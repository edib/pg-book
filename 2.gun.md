# postgresql dizin yapısı
Varsayılan kurulumda:
- cluster ```/var/lib/pgsql/11/data`` altındadır. 
- çalıştırılabilir dosyalar ```/usr/pgsql-11/bin/``` altındadır.

## data altındaki yeni başlayanlar için önemli dosyalar ve dizinler
- postgresql.conf (Bütün cluster seviyesindeki ayar) 
- pg_hba.conf (cluster erişim ayarı)
- pg_ident.conf (cluster kullanıcı ve sistem kullanıcı eşleştirmesi)
- base: cluster nesnelerinin ve asıl veri bulunur.
- global: 
- log: text logları. erişim logları
- pg_tblspc: oluşturulan tablespacelerin kısa yolları bulunur.
- pg_wal: transacktion logların tutulduğu yer. Olabildiğince uzak durulmalıdır. Asla silinmemelidir. 

* psql postgresql instance'a ulaşmak için kullanılan bir komut satırı istemcisidir. 
## psql kısa yolları
```
--- psql client komutlarının listesi
\? 

--- \d bir schema altındaki tüm nesnelerin listesi
\d
--- tablolar
\dt
 --- gösterimler (views)
\dv
--fonksiyonlar
\df
-- kullanıcılar, roller
\du
-- vb.
```
** psql ile dbnin yolu
```
-- veritabanların dizinleri
select oid, datname from pg_database ;

-- tabloların gerçek dizinleri
select pg_relation_filepath('<tablo_adi');
-[ RECORD 1 ]--------+-----------------
pg_relation_filepath | base/13025/16384
```
- copy komutuyla db içerisine veri aktarımı.
Türkiyenin illeri ve ilçeleri veri setini kullanıyoruz.
```
wget https://raw.githubusercontent.com/edib/publicdata/master/ilce.csv
wget https://raw.githubusercontent.com/edib/publicdata/master/il.csv
```
db de 2 tane tablo oluşturuyor ve aşağıdaki şekilde dosyaları içeri aktarıyoruz.
```
create table il (id serial, il_adi varchar);
create table ilce (id serial, il_id int, ilce_adi varchar);
\copy il (id_il_adi) from il.csv WITH CSV HEADER
\copy ilce (il_id, ilce_adi) from ilce.csv WITH CSV HEADER

```

temp tablespace oluşturma temp adıyla
```
create tablespace temp location '/var/lib/pgsql/11/temp';
```
postgresqql.conf içerisinde
```temp_tablespaces = ''``` satırını buluyoruz. 
ve 
```temp_tablespaces = 'temp'``` şeklinde değiştiriyoruz. reload ediyoruz.

## performans ve explain 
```
explain (analyze, format yaml) <sorgu> 
```
sequential scan
index scan
index bitmap scan
[Explain'i anlamak (https://www.dalibo.org/_media/understanding_explain.pdf)

## foreign data wrapper
https://wiki.postgresql.org/wiki/Foreign_data_wrappers


